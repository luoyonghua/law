<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mock API æµ‹è¯•</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      .container {
        background: white;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }
      .test-section {
        margin-bottom: 30px;
        padding: 15px;
        border: 1px solid #e0e0e0;
        border-radius: 5px;
      }
      .test-section h3 {
        margin-top: 0;
        color: #333;
      }
      button {
        background: #409eff;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        margin-right: 10px;
        margin-bottom: 10px;
      }
      button:hover {
        background: #66b1ff;
      }
      .result {
        background: #f8f9fa;
        border: 1px solid #dee2e6;
        border-radius: 4px;
        padding: 10px;
        margin-top: 10px;
        white-space: pre-wrap;
        font-family: monospace;
        max-height: 300px;
        overflow-y: auto;
      }
      .success {
        border-color: #28a745;
        background-color: #d4edda;
      }
      .error {
        border-color: #dc3545;
        background-color: #f8d7da;
      }
      input {
        padding: 5px;
        margin: 5px;
        border: 1px solid #ccc;
        border-radius: 3px;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>Mock API æµ‹è¯•é¡µé¢</h1>
      <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•æœ¬åœ° Mock API æ˜¯å¦æ­£å¸¸å·¥ä½œ</p>

      <!-- ç™»å½•æµ‹è¯• -->
      <div class="test-section">
        <h3>ğŸ” ç™»å½•æµ‹è¯•</h3>
        <div>
          <input type="text" id="username" placeholder="ç”¨æˆ·å" value="Super" />
          <input type="password" id="password" placeholder="å¯†ç " value="123456" />
          <button onclick="testLogin()">æµ‹è¯•ç™»å½•</button>
        </div>
        <div id="loginResult" class="result"></div>
      </div>

      <!-- ç”¨æˆ·ä¿¡æ¯æµ‹è¯• -->
      <div class="test-section">
        <h3>ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯æµ‹è¯•</h3>
        <button onclick="testUserInfo()">è·å–ç”¨æˆ·ä¿¡æ¯</button>
        <div id="userInfoResult" class="result"></div>
      </div>

      <!-- ç”¨æˆ·åˆ—è¡¨æµ‹è¯• -->
      <div class="test-section">
        <h3>ğŸ“‹ ç”¨æˆ·åˆ—è¡¨æµ‹è¯•</h3>
        <div>
          <input type="number" id="current" placeholder="é¡µç " value="1" min="1" />
          <input type="number" id="size" placeholder="æ¯é¡µæ¡æ•°" value="10" min="1" />
          <input type="text" id="searchUser" placeholder="æœç´¢ç”¨æˆ·å" />
          <button onclick="testUserList()">è·å–ç”¨æˆ·åˆ—è¡¨</button>
        </div>
        <div id="userListResult" class="result"></div>
      </div>

      <!-- è§’è‰²åˆ—è¡¨æµ‹è¯• -->
      <div class="test-section">
        <h3>ğŸ­ è§’è‰²åˆ—è¡¨æµ‹è¯•</h3>
        <div>
          <input type="number" id="roleCurrent" placeholder="é¡µç " value="1" min="1" />
          <input type="number" id="roleSize" placeholder="æ¯é¡µæ¡æ•°" value="5" min="1" />
          <button onclick="testRoleList()">è·å–è§’è‰²åˆ—è¡¨</button>
        </div>
        <div id="roleListResult" class="result"></div>
      </div>

      <!-- ä»ªè¡¨ç›˜æ•°æ®æµ‹è¯• -->
      <div class="test-section">
        <h3>ğŸ“Š ä»ªè¡¨ç›˜æ•°æ®æµ‹è¯•</h3>
        <button onclick="testDashboardStats()">è·å–ç»Ÿè®¡æ•°æ®</button>
        <button onclick="testDashboardActivities()">è·å–æ´»åŠ¨è®°å½•</button>
        <button onclick="testDashboardTodos()">è·å–å¾…åŠäº‹é¡¹</button>
        <div id="dashboardResult" class="result"></div>
      </div>
    </div>

    <script>
      let currentToken = ''

      // é€šç”¨è¯·æ±‚å‡½æ•°
      async function makeRequest(url, options = {}) {
        const defaultOptions = {
          headers: {
            'Content-Type': 'application/json',
            ...(currentToken && { Authorization: currentToken })
          }
        }

        const finalOptions = {
          ...defaultOptions,
          ...options,
          headers: {
            ...defaultOptions.headers,
            ...options.headers
          }
        }

        try {
          const response = await fetch(url, finalOptions)
          const data = await response.json()
          return { success: true, data, status: response.status }
        } catch (error) {
          return { success: false, error: error.message }
        }
      }

      // æ˜¾ç¤ºç»“æœ
      function showResult(elementId, result, isSuccess = true) {
        const element = document.getElementById(elementId)
        element.textContent = JSON.stringify(result, null, 2)
        element.className = `result ${isSuccess ? 'success' : 'error'}`
      }

      // æµ‹è¯•ç™»å½•
      async function testLogin() {
        const username = document.getElementById('username').value
        const password = document.getElementById('password').value

        const result = await makeRequest('/api/auth/login', {
          method: 'POST',
          body: JSON.stringify({ userName: username, password })
        })

        if (result.success && result.data.code === 200) {
          currentToken = result.data.data.token
          showResult('loginResult', result.data, true)
        } else {
          showResult('loginResult', result, false)
        }
      }

      // æµ‹è¯•è·å–ç”¨æˆ·ä¿¡æ¯
      async function testUserInfo() {
        if (!currentToken) {
          showResult('userInfoResult', { error: 'è¯·å…ˆç™»å½•è·å– token' }, false)
          return
        }

        const result = await makeRequest('/api/user/info')
        showResult('userInfoResult', result.data || result, result.success)
      }

      // æµ‹è¯•ç”¨æˆ·åˆ—è¡¨
      async function testUserList() {
        const current = document.getElementById('current').value
        const size = document.getElementById('size').value
        const userName = document.getElementById('searchUser').value

        let url = `/api/user/list?current=${current}&size=${size}`
        if (userName) {
          url += `&userName=${encodeURIComponent(userName)}`
        }

        const result = await makeRequest(url)
        showResult('userListResult', result.data || result, result.success)
      }

      // æµ‹è¯•è§’è‰²åˆ—è¡¨
      async function testRoleList() {
        const current = document.getElementById('roleCurrent').value
        const size = document.getElementById('roleSize').value

        const url = `/api/role/list?current=${current}&size=${size}`
        const result = await makeRequest(url)
        showResult('roleListResult', result.data || result, result.success)
      }

      // æµ‹è¯•ä»ªè¡¨ç›˜ç»Ÿè®¡æ•°æ®
      async function testDashboardStats() {
        const result = await makeRequest('/api/dashboard/stats')
        showResult('dashboardResult', result.data || result, result.success)
      }

      // æµ‹è¯•ä»ªè¡¨ç›˜æ´»åŠ¨è®°å½•
      async function testDashboardActivities() {
        const result = await makeRequest('/api/dashboard/activities')
        showResult('dashboardResult', result.data || result, result.success)
      }

      // æµ‹è¯•ä»ªè¡¨ç›˜å¾…åŠäº‹é¡¹
      async function testDashboardTodos() {
        const result = await makeRequest('/api/dashboard/todos')
        showResult('dashboardResult', result.data || result, result.success)
      }

      // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function () {
        console.log('Mock API æµ‹è¯•é¡µé¢å·²åŠ è½½')
        console.log('å¯ç”¨çš„æµ‹è¯•è´¦å·:')
        console.log('- Super / 123456 (è¶…çº§ç®¡ç†å‘˜)')
        console.log('- Admin / 123456 (ç®¡ç†å‘˜)')
        console.log('- User / 123456 (æ™®é€šç”¨æˆ·)')
      })
    </script>
  </body>
</html>
