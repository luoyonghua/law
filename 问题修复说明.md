# æ–‡ä¹¦åˆ—è¡¨æ˜¾ç¤ºé—®é¢˜ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

**ç—‡çŠ¶**: æ–‡ä¹¦åˆ—è¡¨æ¥å£ `https://law_cwd.app.xdo.icu/api/documents/` æœ‰æ•°æ®è¿”å›ï¼Œä½†é¡µé¢åˆ—è¡¨ä¸ºç©ºã€‚

## ğŸ” é—®é¢˜åˆ†æ

### 1. API è¿”å›æ ¼å¼

åç«¯ API è¿”å›çš„æ•°æ®æ ¼å¼ï¼š
```json
{
    "code": 200,
    "msg": "æ–‡æ¡£åˆ—è¡¨è·å–æˆåŠŸï¼Œå…± 10 ä¸ªæ–‡æ¡£",
    "data": [
        {
            "doc_id": "doc_00b999a82c8d",
            "file_name": "å®¡æŸ¥é€®æ•æ„è§ä¹¦_å¼ ä¸‰æ¡ˆ.docx",
            ...
        }
    ]
}
```

### 2. è¯·æ±‚å¤„ç†æµç¨‹

`documentRequest` çš„ `request` å‡½æ•°ï¼š
```typescript
async function request<T = any>(config: ExtendedAxiosRequestConfig): Promise<T> {
  const res = await documentAxiosInstance.request<BaseResponse<T>>(config)
  return res.data.data as T  // è¿”å› res.data.data
}
```

è¿™æ„å‘³ç€ï¼š
- è¾“å…¥ï¼š`{ code: 200, msg: "...", data: [...] }`
- è¾“å‡ºï¼š`[...]`ï¼ˆç›´æ¥è¿”å› data å­—æ®µï¼‰

### 3. å‰ç«¯ä»£ç é—®é¢˜

**é”™è¯¯çš„ä»£ç **ï¼š
```typescript
// src/api/documents.ts
export function fetchDocumentList() {
  return documentRequest.get<Api.Documents.DocumentListResponse>({
    url: '/api/documents/'
  })
}

// src/views/documents/list/index.vue
const data = await fetchDocumentList()
documents.value = data.data || []  // âŒ é”™è¯¯ï¼šdata.data æ˜¯ undefined
```

**é—®é¢˜**ï¼š
- `fetchDocumentList()` è¿”å›çš„ç±»å‹æ˜¯ `DocumentListResponse`ï¼ˆåŒ…å« codeã€msgã€dataï¼‰
- ä½†å®é™…è¿”å›çš„æ˜¯ `DocumentInfo[]`ï¼ˆæ•°ç»„ï¼‰
- æ‰€ä»¥ `data.data` æ˜¯ `undefined`ï¼Œå¯¼è‡´åˆ—è¡¨ä¸ºç©º

## âœ… è§£å†³æ–¹æ¡ˆ

### ä¿®æ”¹ 1: API è°ƒç”¨è¿”å›ç±»å‹

**æ–‡ä»¶**: `src/api/documents.ts`

```typescript
// ä¿®æ”¹å‰
export function fetchDocumentList() {
  return documentRequest.get<Api.Documents.DocumentListResponse>({
    url: '/api/documents/'
  })
}

// ä¿®æ”¹å
export function fetchDocumentList() {
  return documentRequest.get<Api.Documents.DocumentInfo[]>({
    url: '/api/documents/'
  })
}
```

### ä¿®æ”¹ 2: å‰ç«¯æ•°æ®å¤„ç†

**æ–‡ä»¶**: `src/views/documents/list/index.vue`

```typescript
// ä¿®æ”¹å‰
const getDocumentList = async () => {
  loading.value = true
  try {
    const data = await fetchDocumentList()
    documents.value = data.data || []  // âŒ é”™è¯¯
  } catch (error) {
    ElMessage.error('è·å–æ–‡æ¡£åˆ—è¡¨å¤±è´¥')
  } finally {
    loading.value = false
  }
}

// ä¿®æ”¹å
const getDocumentList = async () => {
  loading.value = true
  try {
    const data = await fetchDocumentList()
    documents.value = data || []  // âœ… æ­£ç¡®
  } catch (error) {
    ElMessage.error('è·å–æ–‡æ¡£åˆ—è¡¨å¤±è´¥')
  } finally {
    loading.value = false
  }
}
```

## ğŸ“Š æ•°æ®æµè½¬

### ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰

```
åç«¯è¿”å›
{ code: 200, msg: "...", data: [...] }
    â†“
documentRequest å¤„ç†
return res.data.data  // è¿”å› [...]
    â†“
fetchDocumentList() è¿”å›
[...]  // ä½†ç±»å‹æ ‡æ³¨ä¸º DocumentListResponse
    â†“
å‰ç«¯å¤„ç†
data.data  // undefined âŒ
```

### ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰

```
åç«¯è¿”å›
{ code: 200, msg: "...", data: [...] }
    â†“
documentRequest å¤„ç†
return res.data.data  // è¿”å› [...]
    â†“
fetchDocumentList() è¿”å›
[...]  // ç±»å‹æ ‡æ³¨ä¸º DocumentInfo[]
    â†“
å‰ç«¯å¤„ç†
data  // [...] âœ…
```

## ğŸ§ª éªŒè¯æ–¹æ³•

### 1. å¯åŠ¨é¡¹ç›®
```bash
pnpm dev
```

### 2. æ‰“å¼€æµè§ˆå™¨
è®¿é—® `http://localhost:3006`

### 3. ç™»å½•å¹¶è¿›å…¥æ–‡ä¹¦åˆ—è¡¨
- ç™»å½•ç³»ç»Ÿ
- è¿›å…¥"æ–‡ä¹¦ç®¡ç†" â†’ "æ–‡ä¹¦åˆ—è¡¨"

### 4. æ£€æŸ¥ç»“æœ
- âœ… åˆ—è¡¨åº”è¯¥æ˜¾ç¤ºæ–‡æ¡£æ•°æ®
- âœ… å¯ä»¥çœ‹åˆ°æ–‡ä»¶åã€æ¡ˆä»¶ç¼–å·ã€æ–‡ä¹¦ç±»å‹ç­‰ä¿¡æ¯
- âœ… å¯ä»¥è¿›è¡Œç­›é€‰å’Œæ“ä½œ

### 5. æ£€æŸ¥æ§åˆ¶å°
æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· â†’ Consoleï¼š
- âœ… æ²¡æœ‰é”™è¯¯ä¿¡æ¯
- âœ… Network æ ‡ç­¾æ˜¾ç¤ºè¯·æ±‚æˆåŠŸ
- âœ… Response æ•°æ®æ­£ç¡®

## ğŸ“ å…¶ä»– API æ£€æŸ¥

å…¶ä»– API è°ƒç”¨å·²æ£€æŸ¥ï¼Œæ²¡æœ‰ç±»ä¼¼é—®é¢˜ï¼š

### âœ… æ‰¹é‡ä¸Šä¼ 
```typescript
const response = await uploadDocuments(formData)
batchId.value = response.batch_id  // æ­£ç¡®
```

### âœ… æŸ¥è¯¢è¿›åº¦
```typescript
const status = await fetchBatchStatus(batchId.value)
uploadProgress.value.completed = status.completed_files  // æ­£ç¡®
```

### âœ… ç»“æ„åŒ–æå–
```typescript
const response = await batchStructuredExtract(docIds)
results.value = response.results  // æ­£ç¡®
```

### âœ… æ–‡ä¹¦æ¯”å¯¹
```typescript
const result = await compareDocuments(docIds, comparisonType.value)
compareResult.value = result  // æ­£ç¡®
```

## ğŸ¯ ä¿®å¤æ€»ç»“

**ä¿®æ”¹æ–‡ä»¶**ï¼š
1. `src/api/documents.ts` - ä¿®æ”¹è¿”å›ç±»å‹
2. `src/views/documents/list/index.vue` - ä¿®æ”¹æ•°æ®å¤„ç†

**ä¿®æ”¹å†…å®¹**ï¼š
- å°† `fetchDocumentList()` çš„è¿”å›ç±»å‹ä» `DocumentListResponse` æ”¹ä¸º `DocumentInfo[]`
- å°† `documents.value = data.data` æ”¹ä¸º `documents.value = data`

**å½±å“èŒƒå›´**ï¼š
- ä»…å½±å“æ–‡ä¹¦åˆ—è¡¨é¡µé¢
- å…¶ä»–åŠŸèƒ½ä¸å—å½±å“

## âœ… ä¿®å¤å®Œæˆ

é—®é¢˜å·²ä¿®å¤ï¼Œæ–‡ä¹¦åˆ—è¡¨ç°åœ¨å¯ä»¥æ­£å¸¸æ˜¾ç¤ºæ•°æ®äº†ï¼

---

**ä¿®å¤æ—¶é—´**: 2026-02-06  
**ä¿®å¤äºº**: AI Assistant  
**çŠ¶æ€**: âœ… å·²å®Œæˆ
